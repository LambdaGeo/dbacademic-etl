[2023-03-30T04:56:36.101+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ufrn_etl.run_intake_discentes manual__2023-03-30T04:56:18.612398+00:00 [queued]>
[2023-03-30T04:56:36.117+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: ufrn_etl.run_intake_discentes manual__2023-03-30T04:56:18.612398+00:00 [queued]>
[2023-03-30T04:56:36.118+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2023-03-30T04:56:36.118+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 2
[2023-03-30T04:56:36.118+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2023-03-30T04:56:36.131+0000] {taskinstance.py:1300} INFO - Executing <Task(PythonOperator): run_intake_discentes> on 2023-03-30 04:56:18.612398+00:00
[2023-03-30T04:56:36.139+0000] {standard_task_runner.py:55} INFO - Started process 3606 to run task
[2023-03-30T04:56:36.141+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'ufrn_etl', 'run_intake_discentes', 'manual__2023-03-30T04:56:18.612398+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/ufrn_dag.py', '--cfg-path', '/tmp/tmp38ygrxsv']
[2023-03-30T04:56:36.142+0000] {standard_task_runner.py:83} INFO - Job 44: Subtask run_intake_discentes
[2023-03-30T04:56:36.201+0000] {task_command.py:388} INFO - Running <TaskInstance: ufrn_etl.run_intake_discentes manual__2023-03-30T04:56:18.612398+00:00 [running]> on host 86c02526f58b
[2023-03-30T04:56:36.268+0000] {taskinstance.py:1509} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=breno.nahuz@discente.ufma.br
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ufrn_etl
AIRFLOW_CTX_TASK_ID=run_intake_discentes
AIRFLOW_CTX_EXECUTION_DATE=2023-03-30T04:56:18.612398+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-03-30T04:56:18.612398+00:00
[2023-03-30T04:56:36.269+0000] {logging_mixin.py:137} INFO - [INFO] - Getting data from https://dados.ufrn.br/https://dados.ufrn.br/dataset/554c2d41-cfce-4278-93c6-eb9aa49c5d16/resource/14afbb6c-395e-411c-b24d-0e494cb95866/download/discentes-2023.csv
[2023-03-30T04:56:37.963+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 192, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/etl/extraction/UFRN.py", line 67, in get_students
    dataframe = UFRN_Consumer(students).request(data_type='csv')
  File "/opt/airflow/dags/etl/extraction/consumers/UFRNConsumer.py", line 12, in request
    data = pd.read_csv(self.url, sep=";", decimal=',')
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 586, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 482, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 811, in __init__
    self._engine = self._make_engine(self.engine)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 1040, in _make_engine
    return mapping[engine](self.f, **self.options)  # type: ignore[call-arg]
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 51, in __init__
    self._open_handles(src, kwds)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parsers/base_parser.py", line 229, in _open_handles
    errors=kwds.get("encoding_errors", "strict"),
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 614, in get_handle
    storage_options=storage_options,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 312, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 212, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/usr/local/lib/python3.7/urllib/request.py", line 222, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/local/lib/python3.7/urllib/request.py", line 531, in open
    response = meth(req, response)
  File "/usr/local/lib/python3.7/urllib/request.py", line 641, in http_response
    'http', request, response, code, msg, hdrs)
  File "/usr/local/lib/python3.7/urllib/request.py", line 569, in error
    return self._call_chain(*args)
  File "/usr/local/lib/python3.7/urllib/request.py", line 503, in _call_chain
    result = func(*args)
  File "/usr/local/lib/python3.7/urllib/request.py", line 649, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found
[2023-03-30T04:56:37.976+0000] {taskinstance.py:1323} INFO - Marking task as UP_FOR_RETRY. dag_id=ufrn_etl, task_id=run_intake_discentes, execution_date=20230330T045618, start_date=20230330T045636, end_date=20230330T045637
[2023-03-30T04:56:37.991+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 44 for task run_intake_discentes (HTTP Error 404: Not Found; 3606)
[2023-03-30T04:56:38.040+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2023-03-30T04:56:38.074+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
